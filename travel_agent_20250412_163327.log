2025-04-12 16:33:27,408 - INFO - === Starting Travel Agent Session ===
2025-04-12 16:33:36,054 - USER_INPUT: {
  "messages": [
    {
      "role": "user",
      "content": "What is the weather like in Baku, Azerbaijan?"
    }
  ]
}
2025-04-12 16:33:36,677 - Raw LLM response: ```json
{"type": "weather_request", "location": "Baku, Azerbaijan"}
```
2025-04-12 16:33:36,677 - Weather-related text found in response
2025-04-12 16:33:36,678 - Found location with pattern "location"\s*:\s*"([^"]+)": Baku, Azerbaijan
2025-04-12 16:33:36,678 - Setting location to Baku, Azerbaijan and routing to weather
2025-04-12 16:33:36,679 - ROUTER: request=['get_weather'], location=Baku, Azerbaijan
2025-04-12 16:33:36,679 - ROUTER: Processing request type: get_weather
2025-04-12 16:33:36,680 - ROUTER: Routing to weather with location: Baku, Azerbaijan
2025-04-12 16:33:36,681 - WEATHER: Getting weather for location: Baku, Azerbaijan
2025-04-12 16:33:36,681 - WEATHER: Making API call to OpenWeather with params: {'q': 'Baku, Azerbaijan', 'appid': '5306b1b9e7296497b4754486187b7ce4', 'units': 'metric'}
2025-04-12 16:33:36,684 - Starting new HTTP connection (1): api.openweathermap.org:80
2025-04-12 16:33:36,768 - http://api.openweathermap.org:80 "GET /data/2.5/weather?q=Baku%2C+Azerbaijan&appid=5306b1b9e7296497b4754486187b7ce4&units=metric HTTP/1.1" 200 513
2025-04-12 16:33:36,769 - WEATHER: Got response from OpenWeather: {'coord': {'lon': 49.892, 'lat': 40.3777}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04n'}], 'base': 'stations', 'main': {'temp': 10.03, 'feels_like': 9.2, 'temp_min': 10.03, 'temp_max': 10.03, 'pressure': 1013, 'humidity': 81, 'sea_level': 1013, 'grnd_level': 1012}, 'visibility': 10000, 'wind': {'speed': 10.29, 'deg': 330, 'gust': 15.43}, 'clouds': {'all': 75}, 'dt': 1744500406, 'sys': {'type': 1, 'id': 8841, 'country': 'AZ', 'sunrise': 1744509906, 'sunset': 1744557383}, 'timezone': 14400, 'id': 587084, 'name': 'Baku', 'cod': 200}
2025-04-12 16:33:36,769 - WEATHER: Formatted weather context: {"location": "Baku, Azerbaijan", "current_weather": {"description": "broken clouds", "temperature": 10, "feels_like": 9, "humidity": 81, "wind_speed": 37, "clouds": 75}}
2025-04-12 16:33:36,770 - WEATHER: Sending prompt to LLM: You are a helpful travel assistant. 
Here is the current weather data for Baku, Azerbaijan:
Description: broken clouds
Temperature: 10°C (feels like 9°C)
Humidity: 81%
Wind Speed: 37 km/h
Cloud Cover: 75%

Please provide a helpful, conversational summary of this weather information for a traveler, 
including appropriate clothing suggestions and activity recommendations based on these conditions.
Keep your response concise and natural-sounding. Do not use JSON formatting in your response.
2025-04-12 16:33:38,155 - WEATHER: Got summary from LLM: Okay, here's a quick weather update for Baku:

It's currently 10°C, but feels like 9°C, with broken clouds and quite a bit of wind at 37 km/h. Humidity is also fairly high at 81%.

I'd definitely recommend dressing warmly! Think layers – a sweater or fleece under a windproof jacket would be a good idea. A scarf might be useful too, given the wind.

As for activities, maybe indoor attractions would be best given the wind and cloud cover. Perhaps explore the Heydar Aliyev Center or visit one of Baku's museums. If you do venture outside, stick to areas that are sheltered from the wind. A walk along the boulevard might be okay if you're properly bundled up, but be prepared for a brisk breeze!
2025-04-12 16:33:38,156 - WEATHER: Formatted JSON response: {"type": "weather_response", "message": "Okay, here's a quick weather update for Baku:\n\nIt's currently 10°C, but feels like 9°C, with broken clouds and quite a bit of wind at 37 km/h. Humidity is also fairly high at 81%.\n\nI'd definitely recommend dressing warmly! Think layers – a sweater or fleece under a windproof jacket would be a good idea. A scarf might be useful too, given the wind.\n\nAs for activities, maybe indoor attractions would be best given the wind and cloud cover. Perhaps explore the Heydar Aliyev Center or visit one of Baku's museums. If you do venture outside, stick to areas that are sheltered from the wind. A walk along the boulevard might be okay if you're properly bundled up, but be prepared for a brisk breeze!"}
2025-04-12 16:33:38,156 - WEATHER: Plain weather text (for debugging): Okay, here's a quick weather update for Baku:

It's currently 10°C, but feels like 9°C, with broken clouds and quite a bit of wind at 37 km/h. Humidity is also fairly high at 81%.

I'd definitely recommend dressing warmly! Think layers – a sweater or fleece under a windproof jacket would be a good idea. A scarf might be useful too, given the wind.

As for activities, maybe indoor attractions would be best given the wind and cloud cover. Perhaps explore the Heydar Aliyev Center or visit one of Baku's museums. If you do venture outside, stick to areas that are sheltered from the wind. A walk along the boulevard might be okay if you're properly bundled up, but be prepared for a brisk breeze!
2025-04-12 16:33:38,157 - Chatbot detected we just processed weather, returning without additional prompts
2025-04-12 16:33:38,158 - ROUTER: request=[], location=Baku, Azerbaijan
2025-04-12 16:33:38,158 - ROUTER: Weather data already in state, not routing back to weather
2025-04-12 16:33:38,159 - ===== DEBUG DUMP OF ALL MESSAGES =====
2025-04-12 16:33:38,159 - Message 0 (type=<class 'langchain_core.messages.human.HumanMessage'>): content='What is the weather like in Baku, Azerbaijan?' additional_kwargs={} response_metadata={} id
2025-04-12 16:33:38,159 - Message 1 (type=<class 'langchain_core.messages.ai.AIMessage'>): content='{"type": "weather_response", "message": "Okay, here\'s a quick weather update for Baku:\\n\
2025-04-12 16:33:38,159 - ===== END DEBUG DUMP =====
2025-04-12 16:33:38,160 - INTERNAL_STATE: {
  "messages": [
    {
      "role": "user",
      "content": "What is the weather like in Baku, Azerbaijan?"
    },
    {
      "role": "assistant",
      "content": "{\"type\": \"weather_response\", \"message\": \"Okay, here's a quick weather update for Baku:\\n\\nIt's currently 10\u00b0C, but feels like 9\u00b0C, with broken clouds and quite a bit of wind at 37 km/h. Humidity is also fairly high at 81%.\\n\\nI'd definitely recommend dressing warmly! Think layers \u2013 a sweater or fleece under a windproof jacket would be a good idea. A scarf might be useful too, given the wind.\\n\\nAs for activities, maybe indoor attractions would be best given the wind and cloud cover. Perhaps explore the Heydar Aliyev Center or visit one of Baku's museums. If you do venture outside, stick to areas that are sheltered from the wind. A walk along the boulevard might be okay if you're properly bundled up, but be prepared for a brisk breeze!\"}"
    }
  ],
  "request": [],
  "finished": false,
  "user_profile": {},
  "location": "Baku, Azerbaijan",
  "recommendation": {
    "location": "Baku, Azerbaijan",
    "current_weather": {
      "description": "broken clouds",
      "temperature": 10,
      "feels_like": 9,
      "humidity": 81,
      "wind_speed": 37,
      "clouds": 75
    },
    "raw_text": "Okay, here's a quick weather update for Baku:\n\nIt's currently 10\u00b0C, but feels like 9\u00b0C, with broken clouds and quite a bit of wind at 37 km/h. Humidity is also fairly high at 81%.\n\nI'd definitely recommend dressing warmly! Think layers \u2013 a sweater or fleece under a windproof jacket would be a good idea. A scarf might be useful too, given the wind.\n\nAs for activities, maybe indoor attractions would be best given the wind and cloud cover. Perhaps explore the Heydar Aliyev Center or visit one of Baku's museums. If you do venture outside, stick to areas that are sheltered from the wind. A walk along the boulevard might be okay if you're properly bundled up, but be prepared for a brisk breeze!"
  }
}
2025-04-12 16:33:38,160 - ===== RAW MESSAGES DUMP =====
2025-04-12 16:33:38,161 - ===== END RAW MESSAGES DUMP =====
2025-04-12 16:33:38,161 - SUCCESS: Displayed weather from raw_text field
